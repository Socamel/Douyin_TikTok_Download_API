# ğŸ—„ï¸ SQLiteæ•°æ®åº“ç®¡ç†ç•Œé¢ä½¿ç”¨è¯´æ˜

## ğŸ“‹ æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªåŸºäºStreamlitå¼€å‘çš„SQLiteæ•°æ®åº“ç®¡ç†ç•Œé¢ï¼Œæä¾›äº†å‹å¥½çš„Webç•Œé¢æ¥ç®¡ç†æ‚¨çš„æŠ–éŸ³/TikTokæ•°æ®ã€‚ç•Œé¢ç¾è§‚ã€åŠŸèƒ½å®Œæ•´ã€æ“ä½œç®€å•ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
# å®‰è£…Streamlitå’Œpandas
pip install streamlit pandas

# æˆ–è€…ä½¿ç”¨requirementsæ–‡ä»¶
pip install -r requirements_streamlit.txt
```

### 2. å¯åŠ¨åº”ç”¨

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰
```bash
python start_database_ui.py
```

#### æ–¹æ³•äºŒï¼šç›´æ¥è¿è¡ŒStreamlit
```bash
streamlit run streamlit_database_ui.py --server.port 8501
```

#### æ–¹æ³•ä¸‰ï¼šåå°è¿è¡Œï¼ˆLinux/Macï¼‰
```bash
nohup streamlit run streamlit_database_ui.py --server.port 8501 &
```

### 3. è®¿é—®ç•Œé¢

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š`http://localhost:8501`

## ğŸ“Š åŠŸèƒ½æ¨¡å—è¯¦è§£

### 1. æ•°æ®æ¦‚è§ˆ ğŸ“Š

**åŠŸèƒ½ç‰¹ç‚¹ï¼š**
- å®æ—¶æ˜¾ç¤ºæ•°æ®åº“ç»Ÿè®¡ä¿¡æ¯
- ç¾è§‚çš„æŒ‡æ ‡å¡ç‰‡å±•ç¤º
- æœ€è¿‘æ•°æ®å¿«é€Ÿé¢„è§ˆ

**åŒ…å«å†…å®¹ï¼š**
- **ç”¨æˆ·æ€»æ•°**ï¼šæ•°æ®åº“ä¸­æ³¨å†Œçš„ç”¨æˆ·æ•°é‡
- **è§†é¢‘æ€»æ•°**ï¼šæ‰€æœ‰è§†é¢‘çš„æ•°é‡
- **æ´»è·ƒCookie**ï¼šå½“å‰å¯ç”¨çš„Cookieæ•°é‡
- **æ€»Cookieæ•°**ï¼šæ‰€æœ‰Cookieçš„æ€»æ•°
- **æœ€è¿‘ç”¨æˆ·**ï¼šæœ€è¿‘æ·»åŠ çš„10ä¸ªç”¨æˆ·åˆ—è¡¨
- **æœ€è¿‘Cookie**ï¼šæœ€è¿‘æ·»åŠ çš„5ä¸ªCookieè®°å½•

### 2. ç”¨æˆ·ç®¡ç† ğŸ‘¥

**æ·»åŠ ç”¨æˆ·åŠŸèƒ½ï¼š**
- ç”¨æˆ·IDï¼ˆå¿…å¡«ï¼‰ï¼šæŠ–éŸ³ç”¨æˆ·çš„sec_user_id
- æ˜µç§°ï¼šç”¨æˆ·æ˜¾ç¤ºåç§°
- ç²‰ä¸æ•°ï¼šç”¨æˆ·ç²‰ä¸æ•°é‡
- è§†é¢‘æ•°ï¼šç”¨æˆ·å‘å¸ƒçš„è§†é¢‘æ•°é‡

**ç”¨æˆ·åˆ—è¡¨åŠŸèƒ½ï¼š**
- æ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·ä¿¡æ¯
- æ”¯æŒæœç´¢å’Œç­›é€‰
- å®æ—¶æ•°æ®æ›´æ–°

**åˆ é™¤ç”¨æˆ·åŠŸèƒ½ï¼š**
- é€‰æ‹©è¦åˆ é™¤çš„ç”¨æˆ·
- ç¡®è®¤åˆ é™¤æ“ä½œ
- åˆ é™¤åè‡ªåŠ¨åˆ·æ–°åˆ—è¡¨

### 3. Cookieç®¡ç† ğŸª

**æ·»åŠ CookieåŠŸèƒ½ï¼š**
- Cookieæ•°æ®ï¼ˆå¿…å¡«ï¼‰ï¼šå®Œæ•´çš„Cookieå­—ç¬¦ä¸²
- å¹³å°é€‰æ‹©ï¼šæŠ–éŸ³/TikTok/Bç«™
- è¿‡æœŸæ—¶é—´è®¾ç½®ï¼ˆå¯é€‰ï¼‰
- æ´»è·ƒçŠ¶æ€è®¾ç½®

**Cookieåˆ—è¡¨åŠŸèƒ½ï¼š**
- æ˜¾ç¤ºæ‰€æœ‰Cookieè®°å½•
- å¹³å°åˆ†ç±»ç»Ÿè®¡
- æ´»è·ƒçŠ¶æ€æ˜¾ç¤º

## ğŸ”§ é…ç½®é€‰é¡¹

### ç«¯å£é…ç½®
é»˜è®¤ç«¯å£ï¼š8501
å¦‚éœ€ä¿®æ”¹ç«¯å£ï¼Œå¯ä»¥ï¼š
```bash
streamlit run streamlit_database_ui.py --server.port 8080
```

### ç½‘ç»œè®¿é—®é…ç½®
é»˜è®¤åªå…è®¸æœ¬åœ°è®¿é—®ï¼Œå¦‚éœ€è¿œç¨‹è®¿é—®ï¼š
```bash
streamlit run streamlit_database_ui.py --server.address 0.0.0.0
```

### å®Œæ•´å¯åŠ¨å‘½ä»¤ç¤ºä¾‹
```bash
streamlit run streamlit_database_ui.py \
  --server.port 8501 \
  --server.address 0.0.0.0 \
  --server.headless true \
  --browser.gatherUsageStats false
```

## ğŸ“ æ–‡ä»¶ç»“æ„

```
â”œâ”€â”€ streamlit_database_ui.py    # ä¸»åº”ç”¨æ–‡ä»¶
â”œâ”€â”€ start_database_ui.py        # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ requirements_streamlit.txt  # ä¾èµ–æ–‡ä»¶
â”œâ”€â”€ database.py                 # æ•°æ®åº“ç®¡ç†å™¨
â”œâ”€â”€ douyin_data.db             # SQLiteæ•°æ®åº“æ–‡ä»¶
â””â”€â”€ æ•°æ®åº“ç®¡ç†ç•Œé¢ä½¿ç”¨è¯´æ˜.md    # æœ¬è¯´æ˜æ–‡æ¡£
```

## ğŸ³ Dockeréƒ¨ç½²

### åˆ›å»ºDockerfile
```dockerfile
FROM python:3.9-slim

WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    gcc \
    && rm -rf /var/lib/apt/lists/*

# å¤åˆ¶ä¾èµ–æ–‡ä»¶å¹¶å®‰è£…
COPY requirements_streamlit.txt .
RUN pip install -r requirements_streamlit.txt

# å¤åˆ¶åº”ç”¨æ–‡ä»¶
COPY . .

# æš´éœ²ç«¯å£
EXPOSE 8501

# å¯åŠ¨å‘½ä»¤
CMD ["streamlit", "run", "streamlit_database_ui.py", "--server.port=8501", "--server.address=0.0.0.0"]
```

### æ„å»ºå’Œè¿è¡Œ
```bash
# æ„å»ºé•œåƒ
docker build -t database-ui .

# è¿è¡Œå®¹å™¨
docker run -d -p 8501:8501 --name database-ui database-ui

# æŸ¥çœ‹æ—¥å¿—
docker logs database-ui

# åœæ­¢å®¹å™¨
docker stop database-ui
```

### Docker Composeéƒ¨ç½²
åˆ›å»º `docker-compose.yml`ï¼š
```yaml
version: '3.8'
services:
  database-ui:
    build: .
    ports:
      - "8501:8501"
    volumes:
      - ./douyin_data.db:/app/douyin_data.db
    restart: unless-stopped
```

è¿è¡Œï¼š
```bash
docker-compose up -d
```

## ğŸ”’ å®‰å…¨æ³¨æ„äº‹é¡¹

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å»ºè®®
1. **ä½¿ç”¨HTTPS**ï¼š
   ```bash
   streamlit run streamlit_database_ui.py --server.port 443 --server.sslCertFile cert.pem --server.sslKeyFile key.pem
   ```

2. **é…ç½®èº«ä»½éªŒè¯**ï¼š
   - ä½¿ç”¨Nginxåå‘ä»£ç†
   - é…ç½®Basic Auth
   - ä½¿ç”¨OAuth2è®¤è¯

3. **é™åˆ¶ç½‘ç»œè®¿é—®**ï¼š
   - åªå…è®¸ç‰¹å®šIPè®¿é—®
   - ä½¿ç”¨é˜²ç«å¢™è§„åˆ™
   - é…ç½®VPNè®¿é—®

### æ•°æ®å®‰å…¨
1. **å®šæœŸå¤‡ä»½**ï¼š
   ```bash
   # å¤‡ä»½æ•°æ®åº“
   cp douyin_data.db backup/douyin_data_$(date +%Y%m%d).db
   ```

2. **ç‰ˆæœ¬æ§åˆ¶**ï¼š
   - å°†é…ç½®æ–‡ä»¶åŠ å…¥Git
   - å®šæœŸæäº¤æ•°æ®åº“ç»“æ„å˜æ›´

3. **æƒé™ç®¡ç†**ï¼š
   - é™åˆ¶æ•°æ®åº“æ–‡ä»¶æƒé™
   - ä½¿ç”¨ä¸“ç”¨ç”¨æˆ·è¿è¡ŒæœåŠ¡

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

#### 1. ç«¯å£è¢«å ç”¨
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
netstat -an | findstr :8501  # Windows
netstat -an | grep :8501     # Linux/Mac

# ä½¿ç”¨å…¶ä»–ç«¯å£
streamlit run streamlit_database_ui.py --server.port 8502
```

#### 2. ä¾èµ–å®‰è£…å¤±è´¥
```bash
# å‡çº§pip
python -m pip install --upgrade pip

# é‡æ–°å®‰è£…ä¾èµ–
pip install --force-reinstall streamlit pandas

# ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows
pip install -r requirements_streamlit.txt
```

#### 3. æ•°æ®åº“è¿æ¥é”™è¯¯
```bash
# æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶
ls -la douyin_data.db

# æ£€æŸ¥æ–‡ä»¶æƒé™
chmod 644 douyin_data.db

# éªŒè¯æ•°æ®åº“å®Œæ•´æ€§
sqlite3 douyin_data.db "PRAGMA integrity_check;"
```

#### 4. ç•Œé¢æ— æ³•è®¿é—®
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
ps aux | grep streamlit

# æ£€æŸ¥é˜²ç«å¢™
sudo ufw status

# é‡å¯æœåŠ¡
pkill -f streamlit
streamlit run streamlit_database_ui.py
```

### æ—¥å¿—æŸ¥çœ‹
Streamlitä¼šè‡ªåŠ¨ç”Ÿæˆæ—¥å¿—ï¼Œå¯ä»¥åœ¨æ§åˆ¶å°æŸ¥çœ‹é”™è¯¯ä¿¡æ¯ï¼š
```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
tail -f ~/.streamlit/logs/streamlit.log
```

## ğŸ“ˆ æ‰©å±•åŠŸèƒ½

### è®¡åˆ’ä¸­çš„åŠŸèƒ½
- [ ] **æ•°æ®å¯¼å‡ºåŠŸèƒ½**ï¼šæ”¯æŒCSVã€Excelæ ¼å¼å¯¼å‡º
- [ ] **æ•°æ®å¯è§†åŒ–å›¾è¡¨**ï¼šç”¨æˆ·å¢é•¿è¶‹åŠ¿ã€è§†é¢‘ç»Ÿè®¡å›¾è¡¨
- [ ] **æ‰¹é‡æ“ä½œåŠŸèƒ½**ï¼šæ‰¹é‡å¯¼å…¥ç”¨æˆ·ã€æ‰¹é‡åˆ é™¤
- [ ] **æ•°æ®å¤‡ä»½/æ¢å¤**ï¼šè‡ªåŠ¨å¤‡ä»½ã€ä¸€é”®æ¢å¤
- [ ] **ç”¨æˆ·æƒé™ç®¡ç†**ï¼šå¤šç”¨æˆ·ç™»å½•ã€æƒé™æ§åˆ¶
- [ ] **APIé›†æˆ**ï¼šä¸ç°æœ‰APIç³»ç»Ÿé›†æˆ
- [ ] **å®æ—¶ç›‘æ§**ï¼šç³»ç»ŸçŠ¶æ€ç›‘æ§ã€æ€§èƒ½æŒ‡æ ‡

### è‡ªå®šä¹‰å¼€å‘æŒ‡å—
å¦‚éœ€æ·»åŠ æ–°åŠŸèƒ½ï¼Œå¯ä»¥ä¿®æ”¹ `streamlit_database_ui.py` æ–‡ä»¶ï¼š

1. **æ·»åŠ æ–°é¡µé¢**ï¼š
   ```python
   def show_new_page():
       st.header("æ–°åŠŸèƒ½é¡µé¢")
       # æ·»åŠ åŠŸèƒ½ä»£ç 
   
   # åœ¨main()å‡½æ•°ä¸­æ·»åŠ å¯¼èˆª
   page = st.sidebar.selectbox(
       "é€‰æ‹©é¡µé¢",
       ["ğŸ“Š æ•°æ®æ¦‚è§ˆ", "ğŸ‘¥ ç”¨æˆ·ç®¡ç†", "ğŸª Cookieç®¡ç†", "ğŸ†• æ–°åŠŸèƒ½"]
   )
   ```

2. **æ·»åŠ æ•°æ®åº“æ“ä½œ**ï¼š
   ```python
   # åœ¨database.pyä¸­æ·»åŠ æ–°æ–¹æ³•
   def new_database_operation(self):
       # å®ç°æ•°æ®åº“æ“ä½œ
       pass
   ```

3. **æ·»åŠ è¡¨å•éªŒè¯**ï¼š
   ```python
   if st.form_submit_button("æäº¤"):
       if not user_id:
           st.error("ç”¨æˆ·IDä¸èƒ½ä¸ºç©º")
       elif len(user_id) < 10:
           st.error("ç”¨æˆ·IDæ ¼å¼ä¸æ­£ç¡®")
       else:
           # å¤„ç†æäº¤
           pass
   ```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### ç³»ç»Ÿè¦æ±‚
- **Pythonç‰ˆæœ¬**ï¼š3.8+
- **æ“ä½œç³»ç»Ÿ**ï¼šWindows 10+, macOS 10.14+, Ubuntu 18.04+
- **å†…å­˜**ï¼šæœ€å°‘512MBï¼Œæ¨è2GB+
- **å­˜å‚¨**ï¼šæœ€å°‘100MBå¯ç”¨ç©ºé—´

### è·å–å¸®åŠ©
å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ£€æŸ¥ï¼š

1. **æ£€æŸ¥ç¯å¢ƒ**ï¼š
   ```bash
   python --version
   pip list | grep streamlit
   ```

2. **æ£€æŸ¥æ•°æ®åº“**ï¼š
   ```bash
   sqlite3 douyin_data.db ".tables"
   ```

3. **æ£€æŸ¥ç½‘ç»œ**ï¼š
   ```bash
   curl http://localhost:8501
   ```

4. **æŸ¥çœ‹é”™è¯¯æ—¥å¿—**ï¼š
   - æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
   - Streamlitæ—¥å¿—æ–‡ä»¶
   - ç³»ç»Ÿæ—¥å¿—

### å¸¸è§é”™è¯¯ä»£ç 
- **ModuleNotFoundError**ï¼šä¾èµ–æœªå®‰è£…
- **PermissionError**ï¼šæ–‡ä»¶æƒé™é—®é¢˜
- **ConnectionRefusedError**ï¼šç«¯å£è¢«å ç”¨
- **DatabaseError**ï¼šæ•°æ®åº“æ–‡ä»¶æŸå

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-08-31)
- âœ… åŸºç¡€æ•°æ®æ¦‚è§ˆåŠŸèƒ½
- âœ… ç”¨æˆ·ç®¡ç†åŠŸèƒ½ï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰
- âœ… Cookieç®¡ç†åŠŸèƒ½
- âœ… å“åº”å¼ç•Œé¢è®¾è®¡
- âœ… å®æ—¶æ•°æ®æ›´æ–°
- âœ… é”™è¯¯å¤„ç†å’Œæç¤º
- âœ… å¤šå¹³å°æ”¯æŒï¼ˆWindows/Linux/Macï¼‰

### æœªæ¥ç‰ˆæœ¬è®¡åˆ’
- **v1.1.0**ï¼šæ·»åŠ æ•°æ®å¯¼å‡ºåŠŸèƒ½
- **v1.2.0**ï¼šæ·»åŠ æ•°æ®å¯è§†åŒ–
- **v1.3.0**ï¼šæ·»åŠ æ‰¹é‡æ“ä½œ
- **v2.0.0**ï¼šæ·»åŠ ç”¨æˆ·è®¤è¯ç³»ç»Ÿ

## ğŸ¯ æœ€ä½³å®è·µ

### æ—¥å¸¸ä½¿ç”¨å»ºè®®
1. **å®šæœŸå¤‡ä»½æ•°æ®**ï¼šå»ºè®®æ¯å¤©å¤‡ä»½ä¸€æ¬¡æ•°æ®åº“
2. **ç›‘æ§ç³»ç»ŸçŠ¶æ€**ï¼šå®šæœŸæ£€æŸ¥æœåŠ¡è¿è¡ŒçŠ¶æ€
3. **åŠæ—¶æ›´æ–°ä¾èµ–**ï¼šä¿æŒStreamlitå’Œpandasç‰ˆæœ¬æœ€æ–°
4. **åˆç†è®¾ç½®æƒé™**ï¼šç”Ÿäº§ç¯å¢ƒä½¿ç”¨æœ€å°æƒé™åŸåˆ™

### æ€§èƒ½ä¼˜åŒ–
1. **æ•°æ®åº“ä¼˜åŒ–**ï¼š
   ```sql
   -- åˆ›å»ºç´¢å¼•
   CREATE INDEX idx_users_nickname ON users(nickname);
   CREATE INDEX idx_videos_user_id ON videos(user_id);
   ```

2. **åº”ç”¨ä¼˜åŒ–**ï¼š
   - ä½¿ç”¨åˆ†é¡µæ˜¾ç¤ºå¤§é‡æ•°æ®
   - ç¼“å­˜é¢‘ç¹æŸ¥è¯¢çš„ç»“æœ
   - å¼‚æ­¥å¤„ç†è€—æ—¶æ“ä½œ

3. **ç³»ç»Ÿä¼˜åŒ–**ï¼š
   - å®šæœŸæ¸…ç†æ—¥å¿—æ–‡ä»¶
   - ç›‘æ§å†…å­˜å’ŒCPUä½¿ç”¨
   - ä½¿ç”¨SSDå­˜å‚¨æ•°æ®åº“

---

**ğŸ‰ æ„Ÿè°¢ä½¿ç”¨SQLiteæ•°æ®åº“ç®¡ç†ç•Œé¢ï¼å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·åŠæ—¶åé¦ˆã€‚**
